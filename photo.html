<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <title>A2Z Studio - AI Enhancer Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;800&display=swap" rel="stylesheet"/>
    <style>
        :root { --primary: #007aff; --secondary: #5856d6; --bg: #00040a; }
        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: white; margin: 0;
            background-image: radial-gradient(circle at 50% -20%, #1a2a6c, #00040a 70%);
            background-attachment: fixed;
        }

        /* Premium Glassmorphism */
        .glass-panel { 
            background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(20px); 
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 2.5rem;
        }

        /* Comparison Slider */
        .comparison-wrapper { position: relative; width: 100%; aspect-ratio: 4/5; overflow: hidden; border-radius: 2rem; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
        .img-container { position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; }
        .overlay-layer { 
            position: absolute; inset: 0; width: 50%; overflow: hidden; 
            border-right: 2px solid white; z-index: 10;
        }
        .slider-input { position: absolute; inset: 0; width: 100%; height: 100%; opacity: 0; cursor: col-resize; z-index: 20; }
        
        /* Slider Handle UI */
        .handle-circle {
            position: absolute; top: 50%; right: -15px; transform: translateY(-50%);
            width: 30px; height: 30px; background: white; border-radius: 50%;
            display: flex; items-center; justify-content: center; color: black; font-size: 10px;
            box-shadow: 0 0 20px rgba(255,255,255,0.5); z-index: 11;
        }

        /* Loading Animation */
        .shimmer-bar {
            width: 100%; height: 4px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden;
        }
        .shimmer-progress {
            width: 0%; height: 100%; background: linear-gradient(90deg, #007aff, #5856d6);
            box-shadow: 0 0 10px #007aff; animation: progressMove 3s ease-in-out infinite;
        }
        @keyframes progressMove { 0% { width: 0%; } 50% { width: 70%; } 100% { width: 100%; } }

        .btn-action { 
            background: white; color: black; font-weight: 800; border-radius: 1.2rem;
            transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .btn-action:active { transform: scale(0.95); }
    </style>
</head>
<body class="min-h-screen p-6">

    <div class="max-w-xl mx-auto space-y-10">
        <!-- Minimal Header -->
        <nav class="flex justify-between items-center">
            <a href="index.html" class="w-10 h-10 glass-panel flex items-center justify-center"><i class="fa-solid fa-chevron-left text-xs"></i></a>
            <div class="text-center">
                <h1 class="text-xl font-extrabold tracking-tight">AI ENHANCER</h1>
                <div class="flex items-center justify-center gap-2 mt-1">
                    <span class="w-1 h-1 rounded-full bg-blue-500"></span>
                    <p class="text-[7px] font-bold text-white/40 uppercase tracking-[0.3em]">Neural Engine v2.0</p>
                </div>
            </div>
            <div class="w-10"></div>
        </nav>

        <!-- Initial State: Upload -->
        <div id="view-upload" class="glass-panel p-10 text-center space-y-6" onclick="document.getElementById('file-input').click()">
            <input type="file" id="file-input" class="hidden" accept="image/*" onchange="startEnhancement(event)">
            <div class="w-20 h-20 bg-white/5 rounded-[2rem] flex items-center justify-center mx-auto mb-4 border border-white/5">
                <i class="fa-solid fa-plus text-2xl text-white/50"></i>
            </div>
            <div>
                <h2 class="text-lg font-extrabold uppercase tracking-tight">Select Photo</h2>
                <p class="text-[9px] text-white/30 uppercase mt-2 leading-relaxed">AI will automatically Upscale, Sharpen <br> and fix facial details.</p>
            </div>
        </div>

        <!-- State: Processing -->
        <div id="view-loading" class="hidden glass-panel p-16 text-center space-y-8">
            <div class="relative w-20 h-20 mx-auto">
                <div class="absolute inset-0 border-2 border-white/5 rounded-full"></div>
                <div class="absolute inset-0 border-2 border-blue-500 rounded-full border-t-transparent animate-spin"></div>
                <i class="fa-solid fa-sparkles absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-xl text-blue-500"></i>
            </div>
            <div class="space-y-4">
                <p class="text-[10px] font-bold tracking-[0.4em] uppercase text-blue-400">Enhancing Pixels</p>
                <div class="shimmer-bar mx-auto max-w-[150px]"><div class="shimmer-progress"></div></div>
            </div>
        </div>

        <!-- State: Final Result -->
        <div id="view-result" class="hidden space-y-8">
            <div class="comparison-wrapper glass-panel">
                <!-- Enhanced Image -->
                <img id="img-after" class="img-container"> 
                
                <!-- Original Image Overlay -->
                <div id="slider-overlay" class="overlay-layer">
                    <img id="img-before" class="img-container">
                    <div class="handle-circle">
                        <i class="fa-solid fa-arrows-left-right"></i>
                    </div>
                </div>

                <!-- Slider Control -->
                <input type="range" class="slider-input" min="0" max="100" value="50" oninput="updateSlider(this.value)">

                <!-- Labels -->
                <div class="absolute bottom-6 left-6 z-30 bg-black/40 backdrop-blur-md px-4 py-2 rounded-xl border border-white/10">
                    <p class="text-[8px] font-bold uppercase tracking-widest text-white/50">Original</p>
                </div>
                <div class="absolute bottom-6 right-6 z-30 bg-blue-600/80 backdrop-blur-md px-4 py-2 rounded-xl border border-white/10">
                    <p class="text-[8px] font-bold uppercase tracking-widest">Enhanced HD</p>
                </div>
            </div>

            <div class="flex gap-4">
                <a id="download-link" href="#" download class="btn-action flex-1 py-5 text-center text-[10px] uppercase tracking-widest">
                    Save to Gallery
                </a>
                <button onclick="location.reload()" class="w-16 glass-panel flex items-center justify-center border-white/5">
                    <i class="fa-solid fa-rotate-right text-xs"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- CLOUDINARY CONFIG ---
        const CLOUD_NAME = "dgikim3w1"; 
        const UPLOAD_PRESET = "a2z_preset"; 

        function updateSlider(val) {
            document.getElementById('slider-overlay').style.width = val + "%";
        }

        async function startEnhancement(e) {
            const file = e.target.files[0];
            if(!file) return;

            // Switch UI
            document.getElementById('view-upload').classList.add('hidden');
            document.getElementById('view-loading').classList.remove('hidden');

            // Set Before Image
            document.getElementById('img-before').src = URL.createObjectURL(file);

            // Cloudinary Upload
            const formData = new FormData();
            formData.append("file", file);
            formData.append("upload_preset", UPLOAD_PRESET);

            try {
                const response = await fetch(`https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`, {
                    method: "POST",
                    body: formData
                });
                const data = await response.json();

                if(data.secure_url) {
                    // AI Transformation: Improve colors, Upscale size, Sharpen faces
                    const enhancedUrl = data.secure_url.replace("/upload/", "/upload/e_improve,e_upscale,e_sharpen:80,f_auto,q_auto,w_1600/");
                    
                    const afterImg = document.getElementById('img-after');
                    afterImg.src = enhancedUrl;
                    
                    afterImg.onload = () => {
                        document.getElementById('view-loading').classList.add('hidden');
                        document.getElementById('view-result').classList.remove('hidden');
                        document.getElementById('download-link').href = enhancedUrl.replace("/upload/", "/upload/fl_attachment/");
                    };
                }
            } catch (err) {
                alert("Something went wrong. Please check connection.");
                location.reload();
            }
        }
    </script>
</body>
</html>
