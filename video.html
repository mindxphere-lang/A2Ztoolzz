<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<style>
    :root { --neon: #00d2ff; --bg: #05000a; }
    #vortex-player-app {
        font-family: 'Segoe UI', sans-serif;
        background-color: var(--bg);
        color: white;
        border-radius: 20px;
        padding: 30px;
        position: relative;
        background: radial-gradient(circle at 50% 0%, #001f3f, var(--bg) 85%);
    }

    /* Glassmorphism Player */
    .glass-player {
        background: rgba(15, 23, 42, 0.8);
        backdrop-filter: blur(15px);
        border: 1px solid rgba(0, 210, 255, 0.2);
        border-radius: 24px;
        overflow: hidden;
    }

    .neon-text {
        background: linear-gradient(to right, #00d2ff, #3a7bd5);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    /* Player Controls Styling */
    video::-webkit-media-controls-panel { background-image: linear-gradient(transparent, rgba(0,0,0,0.8)); }
    
    /* Processing Animation */
    @keyframes orbit {
        from { transform: rotate(0deg) translateX(40px) rotate(0deg); }
        to { transform: rotate(360deg) translateX(40px) rotate(-360deg); }
    }
    .orbit-dot {
        position: absolute; width: 8px; height: 8px; background: var(--neon);
        border-radius: 50%; box-shadow: 0 0 15px var(--neon);
        animation: orbit 2s linear infinite;
    }
</style>

<div id="vortex-player-app" class="w-full max-w-4xl mx-auto shadow-2xl">
    
    <header class="flex justify-between items-center mb-8">
        <div class="flex items-center gap-3">
            <div class="p-2 bg-cyan-500/10 rounded-lg border border-cyan-500/20">
                <i class="fa-solid fa-play-circle text-2xl text-cyan-400"></i>
            </div>
            <h1 class="text-xl font-black tracking-tighter uppercase">Vortex<span class="text-cyan-400 italic">Play</span></h1>
        </div>
        <div class="text-[10px] font-bold text-cyan-400/50 uppercase tracking-widest border border-cyan-400/20 px-3 py-1 rounded-full">
            Neural Stream v2.0
        </div>
    </header>

    <div class="mb-10 text-center">
        <h2 class="text-4xl font-extrabold mb-6 neon-text uppercase italic">Stream Any Content</h2>
        <div class="relative max-w-2xl mx-auto group">
            <input type="text" id="urlInput" 
                class="w-full bg-slate-900/50 border border-slate-700 rounded-2xl py-5 px-6 pl-14 outline-none text-white placeholder-gray-500 focus:border-cyan-500 transition-all shadow-inner"
                placeholder="Paste Instagram/YouTube/TikTok Link..." oninput="detectPlatform()"/>
            <i class="fa-solid fa-link absolute left-6 top-1/2 -translate-y-1/2 text-gray-500 group-focus-within:text-cyan-400"></i>
            <button onclick="fetchStream()" 
                class="absolute right-3 top-1/2 -translate-y-1/2 bg-cyan-600 hover:bg-cyan-500 text-white font-black px-6 py-3 rounded-xl transition-all active:scale-95 text-xs uppercase tracking-widest">
                Play Now
            </button>
        </div>
    </div>

    <div id="loader" class="hidden flex flex-col items-center justify-center py-20">
        <div class="relative w-20 h-20 flex items-center justify-center">
            <div class="orbit-dot"></div>
            <i class="fa-solid fa-atom fa-spin text-4xl text-cyan-400"></i>
        </div>
        <p class="mt-6 text-[10px] font-black uppercase tracking-[0.5em] text-cyan-400 animate-pulse">Establishing Neural Link...</p>
    </div>

    <div id="playerSection" class="hidden animate-fade-in space-y-6">
        <div class="glass-player shadow-2xl shadow-cyan-500/10">
            <video id="vortexPlayer" controls class="w-full aspect-video bg-black" poster="">
                Your browser does not support the video tag.
            </video>
        </div>

        <div class="grid md:grid-cols-3 gap-6">
            <div class="md:col-span-2 bg-slate-900/30 p-6 rounded-3xl border border-white/5">
                <h3 id="vTitle" class="text-lg font-bold text-white mb-2 line-clamp-1 italic text-cyan-400">Video Title</h3>
                <p class="text-xs text-gray-500 uppercase tracking-widest font-bold">Currently Streaming in High Definition</p>
            </div>
            
            <div class="flex items-center justify-center gap-3">
                <button onclick="triggerForceDownload()" class="flex-1 bg-white/5 hover:bg-cyan-500 hover:text-white border border-white/10 p-4 rounded-2xl transition-all group">
                    <i class="fa-solid fa-cloud-arrow-down mb-2 text-xl group-hover:scale-110 block"></i>
                    <span class="text-[9px] font-black uppercase tracking-widest">Force Save</span>
                </button>
            </div>
        </div>
    </div>

    <footer class="mt-12 pt-6 border-t border-white/5 text-center">
        <p class="text-[9px] font-black text-gray-600 uppercase tracking-[0.3em]">Powered by Vortex Neural Engine & Social API</p>
    </footer>
</div>

<script>
// --- CONFIGURATION ---
const API_KEY = 'dd7c68a8f7msh0ba0c907edf8683p1488bcjsnb8a4dfcce84f';
const API_HOST = 'social-download-all-in-one.p.rapidapi.com';

let currentMediaUrl = "";

async function fetchStream() {
    const url = document.getElementById('urlInput').value;
    if(!url) return;

    const loader = document.getElementById('loader');
    const playerSection = document.getElementById('playerSection');
    const video = document.getElementById('vortexPlayer');

    // Reset State
    playerSection.classList.add('hidden');
    loader.classList.remove('hidden');

    try {
        const response = await fetch(`https://${API_HOST}/v1/social/autolink`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-RapidAPI-Key': API_KEY,
                'X-RapidAPI-Host': API_HOST
            },
            body: JSON.stringify({ url: url })
        });

        const data = await response.json();
        
        if (data.medias && data.medias.length > 0) {
            // Pick High Quality URL
            const bestMedia = data.medias.find(m => m.quality.includes('1080') || m.quality.includes('720')) || data.medias[0];
            currentMediaUrl = bestMedia.url;

            // Load to Player
            video.src = currentMediaUrl;
            document.getElementById('vTitle').innerText = data.title || "Vortex Stream";
            video.poster = data.picture || "";

            loader.classList.add('hidden');
            playerSection.classList.remove('hidden');
            video.play();
        }
    } catch (error) {
        loader.classList.add('hidden');
        alert("Neural Link Failed. Check API Key.");
    }
}

// Reuse your Force Engine logic here
function triggerForceDownload() {
    if(!currentMediaUrl) return;
    const forceUrl = "force.html?url=" + encodeURIComponent(currentMediaUrl);
    window.open(forceUrl, '_blank');
}

function detectPlatform() {
    // Basic styling logic can stay here if needed
}
</script>
